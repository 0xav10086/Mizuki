import{o as ie,a as oe,s as C,b as S,r as J}from"./lifecycle.FmKRuIzQ.js";import{l as le,n as h,o as ce,v as K,d as H,f as de,s as c,t as V,w as k,g as t,a as W,p as ue,b as fe,h as n,e as d,x as Y,r as u}from"./utils.DKT8dRW6.js";import{s as me}from"./render.DYxv9a2C.js";import{e as pe,i as he}from"./each.CgcUfKvb.js";import{I as x,h as ve}from"./Icon.CiPbvH3Z.js";import{b as j}from"./input.BgGIW5pU.js";import{I as q}from"./zh_TW.DVmOe1ig.js";import{i as A}from"./translation.DFNYCxZG.js";import{n as be}from"./navigation-utils.Cc6bKnia.js";import{u as G}from"./url-utils.D5J_Y8r6.js";/* empty css                        */import"./if.CXLQz50p.js";import"./props.DuKyjVO1.js";import"./config.DTw0xwDh.js";var ge=H(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-sm text-50"><!></div></a>`),we=H(`<div id="search-bar" role="button" tabindex="0" aria-label="Search"><!> <input id="search-input-desktop"/></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed absolute md:w-[30rem] top-20 left-4 md:left-[unset] right-4 z-50 search-panel shadow-2xl rounded-2xl p-2"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function Re(N,O){fe(O,!0);let i=h(""),v=h(""),o=h(ce([])),y=!1,b=h(!1),s=h(!1),_,T=!1,I,P;const ke=[{url:G("/"),meta:{title:"This Is a Fake Search Result"},excerpt:"Because the search cannot work in the <mark>dev</mark> environment."},{url:G("/"),meta:{title:"If You Want to Test the Search"},excerpt:"Try running <mark>npm build && npm preview</mark> instead."}],Q=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},B=()=>{T||(n(s,!t(s)),t(s)&&setTimeout(()=>{document.getElementById("search-input-desktop")?.focus()},0))},U=()=>{t(i)||n(s,!1)},X=()=>{P=setTimeout(()=>{n(s,!1),m(!1,!0)},200)},m=(e,a)=>{const r=document.getElementById("search-panel");!r||!a||(e?r.classList.remove("float-panel-closed"):r.classList.add("float-panel-closed"))},Z=()=>{const e=document.getElementById("search-panel");e&&e.classList.add("float-panel-closed"),n(i,""),n(v,""),n(o,[],!0)},ee=(e,a)=>{e.preventDefault(),Z(),be(a)},$=async(e,a)=>{if(!e){m(!1,a),n(o,[],!0);return}if(t(b))try{let r=[];if(y&&window.pagefind){const p=await window.pagefind.search(e);r=await Promise.all(p.results.map(w=>w.data()))}else r=[],console.error("Pagefind is not available in production environment.");n(o,r,!0),m(t(o).length>0,a)}catch(r){console.error("Search error:",r),n(o,[],!0),m(!1,a)}};ie(()=>{const e=()=>{n(b,!0),y=typeof window<"u"&&!!window.pagefind&&typeof window.pagefind.search=="function",console.log("Pagefind status on init:",y)};document.addEventListener("pagefindready",()=>{console.log("Pagefind ready event received."),e()}),document.addEventListener("pagefindloaderror",()=>{console.warn("Pagefind load error event received. Search functionality will be limited."),e()}),setTimeout(()=>{t(b)||(console.log("Fallback: Initializing search after timeout."),e())},2e3);const a=()=>{T=!0,clearTimeout(I),I=setTimeout(()=>{T=!1},500)};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}}),K(()=>{if(t(b)){const e=t(i)||t(v),a=!!t(i)||t(s);clearTimeout(_),e?_=setTimeout(()=>{$(e,a)},300):(n(o,[],!0),m(!1,a))}}),K(()=>{if(typeof document<"u"){const e=document.getElementById("navbar");t(s)?e?.classList.add("is-searching"):e?.classList.remove("is-searching")}}),oe(()=>{typeof document<"u"&&document.getElementById("navbar")?.classList.remove("is-searching"),clearTimeout(_),clearTimeout(I)});var D=we(),l=de(D);l.__click=()=>{document.getElementById("search-input-desktop")?.focus()};var z=d(l);{let e=Y(()=>t(s)?"left-3":"left-1/2 -translate-x-1/2"),a=Y(()=>t(s)?"text-black/30 dark:text-white/30":"");x(z,{icon:"material-symbols:search",get class(){return`absolute text-[1.25rem] pointer-events-none ${t(e)??""} transition top-1/2 -translate-y-1/2 ${t(a)??""}`}})}var f=c(z,2);J(f),u(l);var g=c(l,2);g.__click=Q;var te=d(g);x(te,{icon:"material-symbols:search",class:"text-[1.25rem]"}),u(g);var F=c(g,2),E=d(F),R=d(E);x(R,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var L=c(R,2);J(L),u(E);var ae=c(E,2);pe(ae,17,()=>t(o),he,(e,a)=>{var r=ge();r.__click=ne=>ee(ne,t(a).url);var p=d(r),w=d(p,!0),re=c(w);x(re,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),u(p);var M=c(p,2),se=d(M);ve(se,()=>t(a).excerpt),u(M),u(r),V(()=>{S(r,"href",t(a).url),me(w,t(a).meta.title)}),W(e,r)}),u(F),V((e,a)=>{C(l,1,`hidden lg:flex transition-all items-center h-11 rounded-lg relative shrink-0
        ${t(s)?"bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06] dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10":"btn-plain active:scale-90"}
        ${t(s)?"w-48":"w-11"}`),S(f,"placeholder",e),C(f,1,`transition-all pl-10 text-sm bg-transparent outline-0
            h-full ${t(s)?"w-36":"w-0"} text-black/50 dark:text-white/50`,"svelte-1wah7ro"),S(L,"placeholder",a)},[()=>A(q.search),()=>A(q.search)]),k("mouseenter",l,()=>{t(s)||B()}),k("mouseleave",l,U),k("focus",f,()=>{clearTimeout(P),t(s)||B(),$(t(i),!0)}),k("blur",f,X),j(f,()=>t(i),e=>n(i,e)),j(L,()=>t(v),e=>n(v,e)),W(N,D),ue()}le(["click"]);export{Re as default};
